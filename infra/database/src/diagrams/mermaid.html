<!doctype html>
<html lang="en" data-bs-theme="dark">
	<head>
		<title>dev_local entity specification</title>
		<meta charset="utf-8" />
		<script src="https://cdn.jsdelivr.net/npm/mermaid@10.9.0/dist/mermaid.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/svg-pan-zoom@3.6.1/dist/svg-pan-zoom.min.js"></script>
		<link
			crossorigin="anonymous"
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css"
			integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9"
			rel="stylesheet"
		/>
		<script
			crossorigin="anonymous"
			integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
			src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
		></script>
		<style>
			.bd-aside a {
				padding: 0.1875rem 0.5rem;
				margin-top: 0.125rem;
				margin-left: 0.3125rem;
				color: var(--bs-body-color);
			}

			.bd-aside a:hover,
			.bd-aside a:focus {
				color: var(--bs-body-color);
				background-color: rgba(121, 82, 179, 0.1);
			}

			.bd-aside .active {
				font-weight: 600;
				color: var(--bs-body-color);
			}

			.bd-aside .btn {
				padding: 0.25rem 0.5rem;
				font-weight: 600;
				color: var(--bs-body-color);
			}

			.bd-aside .btn:hover,
			.bd-aside .btn:focus {
				color: var(--bs-body-color);
				background-color: rgba(121, 82, 179, 0.1);
			}

			.bd-aside .btn:focus {
				box-shadow: 0 0 0 1px rgba(121, 82, 179, 0.7);
			}

			.bd-aside .btn::before {
				width: 1.25em;
				line-height: 0;
				content: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23ccc' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M5 14l6-6-6-6'/%3e%3c/svg%3e");
				transition: transform 0.35s ease;

				/* rtl:raw:
transform: rotate(180deg) translateX(-2px);
*/
				transform-origin: 0.5em 50%;
			}

			.bd-aside .btn[aria-expanded='true']::before {
				transform: rotate(90deg) /* rtl:ignore */;
			}

			/* Layout */
			@media (min-width: 1200px) {
				html {
					scroll-padding-top: 4rem;
				}

				body {
					display: grid;
					grid-template-rows: auto;
					grid-template-columns: 4fr 1fr;
					gap: 1rem;
				}

				.bd-header {
					position: fixed;
					top: 0;
					/* rtl:begin:ignore */
					right: 0;
					left: 0;
					/* rtl:end:ignore */
					z-index: 1030;
					grid-column: 1 / span 3;
				}

				.bd-aside,
				.bd-cheatsheet {
					padding-top: 4rem;
				}

				/**
* 1. Too bad only Firefox supports subgrids ATM
*/
				.bd-cheatsheet,
				.bd-cheatsheet section,
				.bd-cheatsheet article {
					display: inherit; /* 1 */
					grid-template-rows: auto;
					grid-template-columns: 4fr;
					grid-column: 1 / span 2;
					gap: inherit; /* 1 */
				}

				.bd-aside {
					grid-area: 1 / 3;
					scroll-margin-top: 4rem;
				}

				.bd-cheatsheet section,
				.bd-cheatsheet section > h2 {
					top: 2rem;
					scroll-margin-top: 2rem;
				}

				.bd-cheatsheet section > h2::before {
					position: absolute;
					/* rtl:begin:ignore */
					top: 0;
					right: 0;
					bottom: -2rem;
					left: 0;
					/* rtl:end:ignore */
					z-index: -1;
					content: '';
				}

				.bd-cheatsheet article,
				.bd-cheatsheet .bd-heading {
					top: 8rem;
					scroll-margin-top: 8rem;
				}

				.bd-cheatsheet .bd-heading {
					z-index: 1;
				}
			}

			.hide {
				display: none !important;
			}

			.mermaid-box {
				height: 60vh;
				min-height: 600px;
				width: 85vw;
			}

			.mermaid {
				height: 60vh;
				min-height: 600px;
				width: 85vw;
				overflow: hidden;

				svg {
					height: 100% !important;
					width: 100% !important;
				}
			}
		</style>
	</head>

	<body class="bg-body-tertiary">
		<nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
			<div class="container-fluid">
				<a class="navbar-brand" href="/">dev_local</a>
				<button
					aria-controls="navbarCollapse"
					aria-expanded="false"
					aria-label="Toggle navigation"
					class="navbar-toggler"
					data-bs-target="#navbarCollapse"
					data-bs-toggle="collapse"
					type="button"
				>
					<span class="navbar-toggler-icon"></span>
				</button>
				<div class="collapse navbar-collapse" id="navbarCollapse">
					<ul class="navbar-nav me-auto mb-2 mb-md-0">
						<li class="nav-item">
							<a aria-current="page" class="nav-link active" href="mermaid.html">ER Diagram</a>
						</li>
					</ul>
				</div>
			</div>
		</nav>

		<aside class="bd-aside sticky-xl-top text-body-secondary align-self-start mb-3 mb-xl-5 px-2">
			<h2 class="h6 pt-4 pb-3 mb-4 border-bottom">Diagram</h2>
			<nav class="small" id="toc">
				<ul class="list-unstyled">
					<li class="my-2">
						<a
							aria-label="Link to this section: ER Diagram"
							class="anchor-link"
							href="#entity-relationship-mermiad-diagram"
						>
							ER Diagram
						</a>
					</li>

					<li class="my-2">
						<a
							aria-label="Link to this section: Mermaid source code"
							class="anchor-link"
							href="#entity-relationship-mermiad-source-code"
						>
							Mermaid source code
						</a>
					</li>
				</ul>
			</nav>
		</aside>

		<div class="bd-cheatsheet container-fluid bg-body">
			<section id="content">
				<h2 class="title is-3" id="entity-relationship-mermiad-diagram">
					ER Diagram
					<a
						aria-label="Link to this section: Entity Relationship Diagram"
						class="anchor-link"
						href="#entity-relationship-mermiad-diagram"
						>#</a
					>
				</h2>

				<h3 class="title is-4">Diagram</h3>
				<div class="mermaid-box">
					<pre class="mermaid" id="mermaid-pre">
                %%{init: {'theme':'dark'}}%%

erDiagram

"accounts(Account)" {
  *uuid id    PK    
  *uuid userId    FK    
  *varchar(100) name    
  *varchar(50) type    
  varchar(50) subtype    
  varchar(50) number    
  *decimal balance    
  *varchar(10) currencyCode    
  varchar(14) taxNumber    
  varchar(255) owner    
  *timestamp createdAt    
  *timestamp updatedAt    
}


"accounts(Account)"  }o  --  ||  "users(User)":  "userId"

"bank_account_data(BankAccount)" {
  *uuid id    PK    
  *uuid accountId    FK,UK    
  *varchar(50) transferNumber    
  *decimal closingBalance    
}


"bank_account_data(BankAccount)"  |o  --  ||  "accounts(Account)":  "accountId"

"categories(Category)" {
  *uuid id    PK    
  varchar(20) openFinanceId    UK    
  *varchar(255) description    
  *varchar(255) descriptionTranslated    
  *enum type    
  *varchar(255) level1    
  varchar(255) level2    
  varchar(255) level3    
  uuid userId    FK    
  *timestamp createdAt    
  *timestamp updatedAt    
}


"categories(Category)"  }o  --  o|  "users(User)":  "userId"

"credit_account_data(CreditAccount)" {
  *uuid id    PK    
  *uuid accountId    FK,UK    
  *varchar(50) level    
  *varchar(50) brand    
  *timestamp balanceCloseDate    
  *timestamp balanceDueDate    
  *decimal availableCreditLimit    
  *decimal creditLimit    
  *boolean isLimitFlexible    
  *decimal balanceForeignCurrency    
  *decimal minimumPayment    
  *varchar(50) status    
  *varchar(50) holderType    
}


"credit_account_data(CreditAccount)"  |o  --  ||  "accounts(Account)":  "accountId"

"credit_card_transaction_metadata(CreditCardTransactionMetadata)" {
  *uuid id    PK    
  *uuid transactionId    FK,UK    
  *int installmentNumber    
  *int totalInstallments    
  *decimal totalAmount    
}


"credit_card_transaction_metadata(CreditCardTransactionMetadata)"  |o  --  ||  "transactions(Transaction)":  "transactionId"

"exchange_rates(ExchangeRate)" {
  *uuid id    PK    
  *varchar(10) fromCurrency    
  *varchar(10) toCurrency    
  *decimal rate    
  *timestamp recordedAt    
}



"stripe_customers(StripeCustomer)" {
  *number id    PK    
  *varchar(255) stripeCustomerId    UK    
  varchar(255) defaultPaymentMethod    
  uuid user    FK    
}


"stripe_customers(StripeCustomer)"  }o  --  o|  "users(User)":  "user_id"

"stripe_invoices(StripeInvoice)" {
  *number id    PK    
  *varchar(255) stripeInvoiceId    UK    
  *int amountDue    
  *varchar(255) currency    
  *varchar(255) status    
  text hostedInvoiceUrl    
  *timestamp createdAt    
  uuid user    FK    
}


"stripe_invoices(StripeInvoice)"  }o  --  o|  "users(User)":  "user_id"

"stripe_payment_intents(StripePaymentIntent)" {
  *number id    PK    
  *varchar(255) stripePaymentIntentId    UK    
  *int amount    
  *varchar(255) currency    
  *varchar(255) status    
  varchar(255) paymentMethod    
  *timestamp createdAt    
  uuid user    FK    
}


"stripe_payment_intents(StripePaymentIntent)"  }o  --  o|  "users(User)":  "user_id"

"stripe_subscriptions(StripeSubscription)" {
  *number id    PK    
  *varchar(255) stripeSubscriptionId    UK    
  varchar(255) priceId    
  *varchar(255) status    
  timestamp currentPeriodStart    
  timestamp currentPeriodEnd    
  *boolean cancelAtPeriodEnd    
  timestamp canceledAt    
  uuid user    FK    
}


"stripe_subscriptions(StripeSubscription)"  }o  --  o|  "users(User)":  "user_id"

"stripe_webhook_events(StripeWebhookEvent)" {
  *number id    PK    
  *varchar(255) stripeEventId    UK    
  *varchar(255) eventType    
  *timestamp receivedAt    
  *boolean processed    
  jsonb rawPayload    
}



"budgets(Budget)" {
  *uuid id    PK    
  *uuid userId    FK    
  *uuid categoryId    FK    
  *decimal amount    
  *varchar(10) period    
  *timestamp startDate    
  *timestamp endDate    
  *timestamp createdAt    
  *timestamp updatedAt    
}


"budgets(Budget)"  }o  --  ||  "users(User)":  "userId"
"budgets(Budget)"  }o  --  ||  "categories(Category)":  "categoryId"

"budget_category_links(BudgetCategoryLink)" {
  *uuid id    PK    
  *uuid budgetId    FK    
  *uuid categoryId    FK    
}


"budget_category_links(BudgetCategoryLink)"  }o  --  ||  "budgets(Budget)":  "budgetId"
"budget_category_links(BudgetCategoryLink)"  }o  --  ||  "categories(Category)":  "categoryId"

"goals(Goal)" {
  *uuid id    PK    
  *uuid userId    FK    
  *varchar(255) title    
  text description    
  *decimal targetAmount    
  *decimal currentAmount    
  *enum type    
  *enum status    
  timestamp startDate    
  timestamp endDate    
  *timestamp createdAt    
  *timestamp updatedAt    
}


"goals(Goal)"  }o  --  ||  "users(User)":  "userId"

"reports(Report)" {
  *uuid id    PK    
  *uuid userId    FK    
  varchar(255) type    
  *json data    
  *timestamp generatedAt    
}


"reports(Report)"  }o  --  ||  "users(User)":  "userId"

"users(User)" {
  *uuid id    PK    
  *varchar(255) fullName    
  varchar(255) companyName    
  *varchar(20) document    
  *varchar(20) taxNumber    
  *enum documentType    
  varchar(255) jobTitle    
  date birthDate    
  enum investorProfile    
  *varchar(10) currency    
  *varchar(10) locale    
  varchar(10) establishmentCode    
  varchar(255) establishmentName    
  *timestamp createdAt    
  *timestamp updatedAt    
}



"user_addresses(UserAddress)" {
  *uuid id    PK    
  *uuid userId    FK    
  *varchar(255) fullAddress    
  *varchar(50) country    
  *varchar(50) state    
  *varchar(50) city    
  *varchar(20) postalCode    
  *varchar(255) primaryAddress    
  *varchar(50) type    
}


"user_addresses(UserAddress)"  }o  --  ||  "users(User)":  "userId"

"user_emails(UserEmail)" {
  *uuid id    PK    
  *uuid userId    FK    
  *varchar(50) type    
  *varchar(255) value    
}


"user_emails(UserEmail)"  }o  --  ||  "users(User)":  "userId"

"user_phone_numbers(UserPhoneNumber)" {
  *uuid id    PK    
  *uuid userId    FK    
  *varchar(50) type    
  *varchar(50) value    
}


"user_phone_numbers(UserPhoneNumber)"  }o  --  ||  "users(User)":  "userId"

"investments(Investment)" {
  *uuid id    PK    
  *uuid userId    FK    
  *varchar(255) name    
  *varchar(50) type    
  *timestamp createdAt    
  *timestamp updatedAt    
}


"investments(Investment)"  }o  --  ||  "users(User)":  "userId"

"investment_transactions(InvestmentTransaction)" {
  *uuid id    PK    
  *uuid investmentId    FK    
  *decimal amount    
  *varchar(10) currencyCode    
  *timestamp date    
  *varchar(50) transactionType    
}


"investment_transactions(InvestmentTransaction)"  }o  --  ||  "investments(Investment)":  "investmentId"

"net_worth_snapshots(NetWorthSnapshot)" {
  *uuid id    PK    
  *uuid userId    
  *decimal totalAssets    
  *decimal totalLiabilities    
  *decimal netWorth    
  *timestamp snapshotDate    
}



"audit_logs(AuditLog)" {
  *uuid id    PK    
  *uuid userId    
  *enum action    
  *enum subject    
  *json details    
  *timestamp createdAt    
}



"notifications(Notification)" {
  *uuid id    PK    
  *uuid userId    
  *varchar(255) title    
  *text message    
  *boolean read    
  *timestamp createdAt    
}



"transactions(Transaction)" {
  *uuid id    PK    
  *uuid userId    FK    
  *uuid accountId    FK    
  *varchar(255) description    
  text descriptionRaw    
  *varchar(10) currencyCode    
  *decimal amount    
  *timestamp date    
  decimal balance    
  varchar(255) category    
  uuid categoryId    FK    
  *varchar(20) type    
  *varchar(20) status    
  varchar(100) providerCode    
  varchar(100) providerId    
  text notes    
  *boolean recurring    
  *timestamp createdAt    
  *timestamp updatedAt    
}


"transactions(Transaction)"  }o  --  ||  "users(User)":  "userId"
"transactions(Transaction)"  }o  --  ||  "accounts(Account)":  "accountId"
"transactions(Transaction)"  }o  --  o|  "categories(Category)":  "categoryId"

"receipts(Receipt)" {
  *uuid id    PK    
  *uuid userId    FK    
  uuid transactionId    FK    
  *varchar(255) merchant    
  *decimal amount    
  *timestamp date    
  *varchar(255) imageUrl    
  *timestamp createdAt    
}


"receipts(Receipt)"  }o  --  ||  "users(User)":  "userId"
"receipts(Receipt)"  }o  --  o|  "transactions(Transaction)":  "transactionId"

"recurring_transactions(RecurringTransaction)" {
  *uuid id    PK    
  *uuid userId    FK    
  *uuid accountId    FK    
  *varchar description    
  *decimal amount    
  *varchar(10) currencyCode    
  *enum recurrence    
  *timestamp nextDueDate    
  timestamp endDate    
  *timestamp createdAt    
  *timestamp updatedAt    
}


"recurring_transactions(RecurringTransaction)"  }o  --  ||  "users(User)":  "userId"
"recurring_transactions(RecurringTransaction)"  }o  --  ||  "accounts(Account)":  "accountId"

"tags(Tag)" {
  *uuid id    PK    
  *uuid userId    FK    
  *varchar(50) name    
}


"tags(Tag)"  }o  --  ||  "users(User)":  "userId"

"transaction_splits(TransactionSplit)" {
  *uuid id    PK    
  *uuid transactionId    FK    
  *uuid categoryId    FK    
  *decimal amount    
}


"transaction_splits(TransactionSplit)"  }o  --  ||  "transactions(Transaction)":  "transactionId"
"transaction_splits(TransactionSplit)"  }o  --  ||  "categories(Category)":  "categoryId"

"transaction_tags(TransactionTag)" {
  *uuid id    PK    
  *uuid transactionId    FK    
  *uuid tagId    FK    
}


"transaction_tags(TransactionTag)"  }o  --  ||  "transactions(Transaction)":  "transactionId"
"transaction_tags(TransactionTag)"  }o  --  ||  "tags(Tag)":  "tagId"

                </pre
					>
				</div>

				<h3 class="title is-4">
					<a
						aria-label="Link to this section: Entity Relationship Diagram Image"
						class="anchor-link"
						href="/dev_local.svg"
						target="_blank"
						>Image</a
					>
				</h3>
			</section>

			<div class="mx-auto p-2" style="width: 100%"></div>

			<section id="content">
				<h2 class="title is-3" id="entity-relationship-mermiad-source-code">
					Mermaid source code
					<a
						aria-label="Link to this section: Mermaid source code"
						class="anchor-link"
						href="#entity-relationship-mermiad-source-code"
						>#</a
					>
				</h2>

				<textarea class="form-control meramid-source-code" rows="10">
%%{init: {'theme':'dark'}}%%

erDiagram

"accounts(Account)" {
  *uuid id    PK    
  *uuid userId    FK    
  *varchar(100) name    
  *varchar(50) type    
  varchar(50) subtype    
  varchar(50) number    
  *decimal balance    
  *varchar(10) currencyCode    
  varchar(14) taxNumber    
  varchar(255) owner    
  *timestamp createdAt    
  *timestamp updatedAt    
}


"accounts(Account)"  }o  --  ||  "users(User)":  "userId"

"bank_account_data(BankAccount)" {
  *uuid id    PK    
  *uuid accountId    FK,UK    
  *varchar(50) transferNumber    
  *decimal closingBalance    
}


"bank_account_data(BankAccount)"  |o  --  ||  "accounts(Account)":  "accountId"

"categories(Category)" {
  *uuid id    PK    
  varchar(20) openFinanceId    UK    
  *varchar(255) description    
  *varchar(255) descriptionTranslated    
  *enum type    
  *varchar(255) level1    
  varchar(255) level2    
  varchar(255) level3    
  uuid userId    FK    
  *timestamp createdAt    
  *timestamp updatedAt    
}


"categories(Category)"  }o  --  o|  "users(User)":  "userId"

"credit_account_data(CreditAccount)" {
  *uuid id    PK    
  *uuid accountId    FK,UK    
  *varchar(50) level    
  *varchar(50) brand    
  *timestamp balanceCloseDate    
  *timestamp balanceDueDate    
  *decimal availableCreditLimit    
  *decimal creditLimit    
  *boolean isLimitFlexible    
  *decimal balanceForeignCurrency    
  *decimal minimumPayment    
  *varchar(50) status    
  *varchar(50) holderType    
}


"credit_account_data(CreditAccount)"  |o  --  ||  "accounts(Account)":  "accountId"

"credit_card_transaction_metadata(CreditCardTransactionMetadata)" {
  *uuid id    PK    
  *uuid transactionId    FK,UK    
  *int installmentNumber    
  *int totalInstallments    
  *decimal totalAmount    
}


"credit_card_transaction_metadata(CreditCardTransactionMetadata)"  |o  --  ||  "transactions(Transaction)":  "transactionId"

"exchange_rates(ExchangeRate)" {
  *uuid id    PK    
  *varchar(10) fromCurrency    
  *varchar(10) toCurrency    
  *decimal rate    
  *timestamp recordedAt    
}



"stripe_customers(StripeCustomer)" {
  *number id    PK    
  *varchar(255) stripeCustomerId    UK    
  varchar(255) defaultPaymentMethod    
  uuid user    FK    
}


"stripe_customers(StripeCustomer)"  }o  --  o|  "users(User)":  "user_id"

"stripe_invoices(StripeInvoice)" {
  *number id    PK    
  *varchar(255) stripeInvoiceId    UK    
  *int amountDue    
  *varchar(255) currency    
  *varchar(255) status    
  text hostedInvoiceUrl    
  *timestamp createdAt    
  uuid user    FK    
}


"stripe_invoices(StripeInvoice)"  }o  --  o|  "users(User)":  "user_id"

"stripe_payment_intents(StripePaymentIntent)" {
  *number id    PK    
  *varchar(255) stripePaymentIntentId    UK    
  *int amount    
  *varchar(255) currency    
  *varchar(255) status    
  varchar(255) paymentMethod    
  *timestamp createdAt    
  uuid user    FK    
}


"stripe_payment_intents(StripePaymentIntent)"  }o  --  o|  "users(User)":  "user_id"

"stripe_subscriptions(StripeSubscription)" {
  *number id    PK    
  *varchar(255) stripeSubscriptionId    UK    
  varchar(255) priceId    
  *varchar(255) status    
  timestamp currentPeriodStart    
  timestamp currentPeriodEnd    
  *boolean cancelAtPeriodEnd    
  timestamp canceledAt    
  uuid user    FK    
}


"stripe_subscriptions(StripeSubscription)"  }o  --  o|  "users(User)":  "user_id"

"stripe_webhook_events(StripeWebhookEvent)" {
  *number id    PK    
  *varchar(255) stripeEventId    UK    
  *varchar(255) eventType    
  *timestamp receivedAt    
  *boolean processed    
  jsonb rawPayload    
}



"budgets(Budget)" {
  *uuid id    PK    
  *uuid userId    FK    
  *uuid categoryId    FK    
  *decimal amount    
  *varchar(10) period    
  *timestamp startDate    
  *timestamp endDate    
  *timestamp createdAt    
  *timestamp updatedAt    
}


"budgets(Budget)"  }o  --  ||  "users(User)":  "userId"
"budgets(Budget)"  }o  --  ||  "categories(Category)":  "categoryId"

"budget_category_links(BudgetCategoryLink)" {
  *uuid id    PK    
  *uuid budgetId    FK    
  *uuid categoryId    FK    
}


"budget_category_links(BudgetCategoryLink)"  }o  --  ||  "budgets(Budget)":  "budgetId"
"budget_category_links(BudgetCategoryLink)"  }o  --  ||  "categories(Category)":  "categoryId"

"goals(Goal)" {
  *uuid id    PK    
  *uuid userId    FK    
  *varchar(255) title    
  text description    
  *decimal targetAmount    
  *decimal currentAmount    
  *enum type    
  *enum status    
  timestamp startDate    
  timestamp endDate    
  *timestamp createdAt    
  *timestamp updatedAt    
}


"goals(Goal)"  }o  --  ||  "users(User)":  "userId"

"reports(Report)" {
  *uuid id    PK    
  *uuid userId    FK    
  varchar(255) type    
  *json data    
  *timestamp generatedAt    
}


"reports(Report)"  }o  --  ||  "users(User)":  "userId"

"users(User)" {
  *uuid id    PK    
  *varchar(255) fullName    
  varchar(255) companyName    
  *varchar(20) document    
  *varchar(20) taxNumber    
  *enum documentType    
  varchar(255) jobTitle    
  date birthDate    
  enum investorProfile    
  *varchar(10) currency    
  *varchar(10) locale    
  varchar(10) establishmentCode    
  varchar(255) establishmentName    
  *timestamp createdAt    
  *timestamp updatedAt    
}



"user_addresses(UserAddress)" {
  *uuid id    PK    
  *uuid userId    FK    
  *varchar(255) fullAddress    
  *varchar(50) country    
  *varchar(50) state    
  *varchar(50) city    
  *varchar(20) postalCode    
  *varchar(255) primaryAddress    
  *varchar(50) type    
}


"user_addresses(UserAddress)"  }o  --  ||  "users(User)":  "userId"

"user_emails(UserEmail)" {
  *uuid id    PK    
  *uuid userId    FK    
  *varchar(50) type    
  *varchar(255) value    
}


"user_emails(UserEmail)"  }o  --  ||  "users(User)":  "userId"

"user_phone_numbers(UserPhoneNumber)" {
  *uuid id    PK    
  *uuid userId    FK    
  *varchar(50) type    
  *varchar(50) value    
}


"user_phone_numbers(UserPhoneNumber)"  }o  --  ||  "users(User)":  "userId"

"investments(Investment)" {
  *uuid id    PK    
  *uuid userId    FK    
  *varchar(255) name    
  *varchar(50) type    
  *timestamp createdAt    
  *timestamp updatedAt    
}


"investments(Investment)"  }o  --  ||  "users(User)":  "userId"

"investment_transactions(InvestmentTransaction)" {
  *uuid id    PK    
  *uuid investmentId    FK    
  *decimal amount    
  *varchar(10) currencyCode    
  *timestamp date    
  *varchar(50) transactionType    
}


"investment_transactions(InvestmentTransaction)"  }o  --  ||  "investments(Investment)":  "investmentId"

"net_worth_snapshots(NetWorthSnapshot)" {
  *uuid id    PK    
  *uuid userId    
  *decimal totalAssets    
  *decimal totalLiabilities    
  *decimal netWorth    
  *timestamp snapshotDate    
}



"audit_logs(AuditLog)" {
  *uuid id    PK    
  *uuid userId    
  *enum action    
  *enum subject    
  *json details    
  *timestamp createdAt    
}



"notifications(Notification)" {
  *uuid id    PK    
  *uuid userId    
  *varchar(255) title    
  *text message    
  *boolean read    
  *timestamp createdAt    
}



"transactions(Transaction)" {
  *uuid id    PK    
  *uuid userId    FK    
  *uuid accountId    FK    
  *varchar(255) description    
  text descriptionRaw    
  *varchar(10) currencyCode    
  *decimal amount    
  *timestamp date    
  decimal balance    
  varchar(255) category    
  uuid categoryId    FK    
  *varchar(20) type    
  *varchar(20) status    
  varchar(100) providerCode    
  varchar(100) providerId    
  text notes    
  *boolean recurring    
  *timestamp createdAt    
  *timestamp updatedAt    
}


"transactions(Transaction)"  }o  --  ||  "users(User)":  "userId"
"transactions(Transaction)"  }o  --  ||  "accounts(Account)":  "accountId"
"transactions(Transaction)"  }o  --  o|  "categories(Category)":  "categoryId"

"receipts(Receipt)" {
  *uuid id    PK    
  *uuid userId    FK    
  uuid transactionId    FK    
  *varchar(255) merchant    
  *decimal amount    
  *timestamp date    
  *varchar(255) imageUrl    
  *timestamp createdAt    
}


"receipts(Receipt)"  }o  --  ||  "users(User)":  "userId"
"receipts(Receipt)"  }o  --  o|  "transactions(Transaction)":  "transactionId"

"recurring_transactions(RecurringTransaction)" {
  *uuid id    PK    
  *uuid userId    FK    
  *uuid accountId    FK    
  *varchar description    
  *decimal amount    
  *varchar(10) currencyCode    
  *enum recurrence    
  *timestamp nextDueDate    
  timestamp endDate    
  *timestamp createdAt    
  *timestamp updatedAt    
}


"recurring_transactions(RecurringTransaction)"  }o  --  ||  "users(User)":  "userId"
"recurring_transactions(RecurringTransaction)"  }o  --  ||  "accounts(Account)":  "accountId"

"tags(Tag)" {
  *uuid id    PK    
  *uuid userId    FK    
  *varchar(50) name    
}


"tags(Tag)"  }o  --  ||  "users(User)":  "userId"

"transaction_splits(TransactionSplit)" {
  *uuid id    PK    
  *uuid transactionId    FK    
  *uuid categoryId    FK    
  *decimal amount    
}


"transaction_splits(TransactionSplit)"  }o  --  ||  "transactions(Transaction)":  "transactionId"
"transaction_splits(TransactionSplit)"  }o  --  ||  "categories(Category)":  "categoryId"

"transaction_tags(TransactionTag)" {
  *uuid id    PK    
  *uuid transactionId    FK    
  *uuid tagId    FK    
}


"transaction_tags(TransactionTag)"  }o  --  ||  "transactions(Transaction)":  "transactionId"
"transaction_tags(TransactionTag)"  }o  --  ||  "tags(Tag)":  "tagId"

</textarea
				>
			</section>

			<div class="mx-auto p-5" style="width: 100%"></div>
		</div>
	</body>
	<script>
		mermaid.initialize({ startOnLoad: true, er: { useMaxWidth: false } })
		setTimeout(() => {
			svgPanZoom(document.querySelector('#mermaid-pre>svg'), {
				minZoom: 0.5,
				maxZoom: 10,
				fit: true,
				contain: false,
				controlIconsEnabled: true,
				center: true,
				refreshRate: 'auto',
			})
		}, 200)
	</script>
</html>
